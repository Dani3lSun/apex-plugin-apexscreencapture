var apexScreenCapture={parseBoolean:function(a){var b;"true"==a.toLowerCase()&&(b=!0);"false"==a.toLowerCase()&&(b=!1);"true"!=a.toLowerCase()&&"false"!=a.toLowerCase()&&(b=void 0);return b},clob2Array:function(a,b,e){loopCount=Math.floor(a.length/b)+1;for(var c=0;c<loopCount;c++)e.push(a.slice(b*c,b*(c+1)));return e},dataURI2base64:function(a){return a.substr(a.indexOf(",")+1)},getBrowserName:function(){var a=navigator.userAgent,b=navigator.appName,e,c;-1!=a.indexOf("Opera")?b="opera":-1!=a.indexOf("MSIE")?
b="ie":-1!=a.indexOf("Trident")?b="ie":-1!=a.indexOf("Edge")?b="edge":-1!=a.indexOf("Chrome")?b="chrome":-1!=a.indexOf("Safari")?b="safari":-1!=a.indexOf("Firefox")?b="firefox":(e=a.lastIndexOf(" ")+1)<(c=a.lastIndexOf("/"))&&(b=a.substring(e,c),b.toLowerCase()==b.toUpperCase()&&(b=navigator.appName));return b},getImage:function(a,b,e,c){var d=b.toDataURL("image/png");"Y"==e?(a=apexScreenCapture.getBrowserName(),"ie"==a||"edge"==a?window.navigator.msSaveBlob(b.msToBlob(),"screenshot.png"):apex.navigation.openInNewWindow(d,
"CapturedImageWindow"),c()):(b=apexScreenCapture.dataURI2base64(d),d=[],d=apexScreenCapture.clob2Array(b,3E4,d),apex.server.plugin(a,{f01:d},{dataType:"html",success:function(){$("body").trigger("screencapture-saved-db");c()},error:function(a,b){$("body").trigger("screencapture-error-db");console.log("getImage: apex.server.plugin ERROR:",b);c()}}))},dohtml2canvas:function(a,b,e,c,d,f,g,k,h){h&&(console.log("dohtml2canvas: HTML element:",a),console.log("dohtml2canvas: element width:",d),console.log("dohtml2canvas: element height:",
f));html2canvas($(a),{onrendered:function(a){var c=apex.util.showSpinner($("body"));apexScreenCapture.getImage(e,a,b,function(){c.remove()})},background:c,width:d,height:f,letterRendering:g,allowTaint:k,logging:h})},dohtml2canvasDom:function(a,b,e,c,d,f,g){a.id?phtmlElem="#"+a.id:a.className&&(phtmlElem=a.tagName.toLowerCase(),phtmlElem+=("."+jQuery.trim(a.className).replace(/ /g,".")).replace(/\.\.+/g,"."));pwidth=$(a).width();pheight=$(a).height();g&&(console.log("dohtml2canvasDom: HTML element:",
phtmlElem),console.log("dohtml2canvasDom: element width:",pwidth),console.log("dohtml2canvasDom: element height:",pheight),console.log("dohtml2canvasDom: Clicked element:",a));html2canvas($(phtmlElem),{onrendered:function(a){var c=apex.util.showSpinner($("body"));apexScreenCapture.getImage(e,a,b,function(){c.remove()})},background:c,width:pwidth,height:pheight,letterRendering:d,allowTaint:f,logging:g})},captureScreen:function(){var a=this.action.ajaxIdentifier,b=this.action.attribute01,e=this.action.attribute02,
c=this.action.attribute04,d=parseInt(this.action.attribute05),f=parseInt(this.action.attribute06),g=apexScreenCapture.parseBoolean(this.action.attribute07),k=apexScreenCapture.parseBoolean(this.action.attribute08),h=apexScreenCapture.parseBoolean(this.action.attribute09),p=this.action.attribute10,l=this.action.attribute11,m=apexScreenCapture.parseBoolean(this.action.attribute12),n=apexScreenCapture.parseBoolean(this.action.attribute13),q=this.action.attribute14,r=parseInt(document.documentElement.clientWidth),
t=parseInt(document.documentElement.clientHeight);if(null===d||void 0===d||isNaN(parseFloat(d)))d=r;if(null===f||void 0===f||isNaN(parseFloat(f)))f=t;if(null===l||void 0===l)l=!1;if(null===m||void 0===m)m=!1;if(null===n||void 0===n)n=!1;h&&(console.log("captureScreen: Attribute JQuery selector:",b),console.log("captureScreen: Attribute open window:",e),console.log("captureScreen: Attribute background:",c),console.log("captureScreen: Attribute element width:",d),console.log("captureScreen: Attribute element height:",
f),console.log("captureScreen: Attribute letter rendering:",g),console.log("captureScreen: Attribute allow taint:",k),console.log("captureScreen: Attribute Logging:",h),console.log("captureScreen: Attribute DOM selector:",p),console.log("captureScreen: Attribute DOM filter:",l),console.log("captureScreen: Attribute hide label:",m),console.log("captureScreen: Attribute fill content:",n),console.log("captureScreen: Attribute border color:",q));"Y"==p?DomOutline({onClick:function(b){apexScreenCapture.dohtml2canvasDom(b,
e,a,c,g,k,h)},filter:l,stopOnClick:!0,borderColor:q,hideLabel:m,fillContent:n}).start():apexScreenCapture.dohtml2canvas(b,e,a,c,d,f,g,k,h)}};
